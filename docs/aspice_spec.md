# RL78F23 I2C ?? ??? ?????? - ASPICE SWE1/2/3 ???

## 1. ??? ??
? ??? RL78F23 ?? ??? I2C ???? ??????? ?? ASPICE SWE.1(????? ????), SWE.2(????? ???? ??), SWE.3(????? ?? ??) ??? ???? ?? ??? ????? ??? ????. ???? ?? ??? Renesas ???? ?? ??? ???? HAL, ????, ?????? ?? ??? ????.

## 2. ?? ??
- Renesas RL78F23 ???? ??? ???
- Renesas Code Generator `r_config_iica0.h`, `r_cg_macrodriver.h`
- MISRA C:2023 ?????
- ASPICE PAM 4.0 (SWE.1/SWE.2/SWE.3 ?? ?? ??)

## 3. SWE.1 - ????? ???? ??

### 3.1 ??
- ?? ??? ???? ??? ???? ??? ???? ?? ?????(`R_Config_IICA0_*`)? ????.
- ??? ? ???? TM00 ISR? ?? 1 ms ????? ????.
- I2C ???? ????? ?? 32???? ???? ??? ? ??.
- ??????? RTOS ?? ?? ??? ?? ??? ????.

### 3.2 ?? ??
- MISRA C:2023? RL78F23? Renesas ????? ???? ??.
- ???? ???? 1 ms ?? ???? ?? ??? ???? ??.
- ?? ? ?? ??? ??? ???? ? ?? ??? ????.

### 3.3 ???? ??
| ID | ???? | ?? | ?? ?? |
|----|-----------|------|-----------|
| REQ-I2C-001 | ???? ???? ?????? ??? I2C ???? ???? ??? ??? ??? ????? ??. | ??? ??? ???? ?? ?? ???? ??. | ??? ???? ??? ??? ?? ??; ? ?? ??? ????. |
| REQ-I2C-002 | ???? IICA ????? ???? ???? ?? ???? ???? ???? ??. | ?? ?? ? ?? ???? ???? ??. | ?? ?? ??; ?? ??? ?? ??? ????. |
| REQ-I2C-003 | ???? 5 ms? ???? ??? ???? ???? ???? ??. | ??? ?? ??? ????? ???? ??. | ??? ?? ?? ??; ???? ??? ????. |
| REQ-I2C-004 | ?? ??? ?? ?? ????? ??? ??? ???? ????? ?? ???? ????? ??? ?? ??. | ????? ?? ??? ??? ???? ??. | ???? ?? ??; ?? ??? ????. |
| REQ-I2C-005 | ???? ???? ??? ??? ?? ?? ?????? ?? ??? ???? ??. | ?? ? ??? ???? ??. | `hal_i2c_report_error` ?? ??. |
| REQ-I2C-006 | ???? ?? ??? ???? ??? ???? HAL API? ???? ??. | ???? ??? ???? ???? ??. | ?? ??; ????? ?? ??. |

## 4. SWE.2 - ????? ???? ??

### 4.1 ?? ??
- **HAL_I2C** (`include/hal_i2c_slave.h`, `app/hal_i2c_slave.c`): ???? ?? ???, ???? ??, ???? ??? ??? ????? `HAL_I2C_S_PopMessage`? ?? ???? ?? ??? ????.
- **HAL_SCHED** (`include/hal_scheduler.h`, `src/hal_scheduler.c`): ? ?? ???? ?? ?? ???? ??? ???? ??? ????? ????.
- **APP_MAIN** (`src/app_main.c`): ???? ???? ???? HAL ??? ????, ??? ??? ??? ???? ????.
- **ISR ??** (`src/timer_isr.c`, `src/r_config_iica0_user.c`): ?????? ??? ????? HAL/???? ????? ????.

### 4.2 ?????
| ?? ????? | ?? | ?? ?? |
|------------------|------|-----------|
| `HAL_I2C_S_Init`, `HAL_I2C_S_Reset`, `HAL_I2C_S_PopMessage` | HAL ??? ? ??? ?? | ?????? ?? |
| `HAL_I2C_S_On*` ?? | ?? ???? ???? ?? ???? ISR? ?? | ???? ??(`r_config_iica0_user.c`) |
| `HAL_SCHED_Init`, `HAL_SCHED_RegisterTasks`, `HAL_SCHED_RunOnce`, `HAL_SCHED_TickISR` | ???? ??? | `app_main.c`, `timer_isr.c` |
| ?? ?? `hal_i2c_error_callback_t` | HAL ??? ??????? ?? | `app_main.c` |

### 4.3 ??? ?? ??
1. I2C ISR(`R_Config_IICA0_*`)? ???? HAL? ????.
2. HAL? ??? ???? ????? ?? ??? ????.
3. ??? ISR? ???? ?? HAL ???? ???? ????.
4. ?? ??? ????? ??? ??? ???? ????, ??? ?? ???? ??? ??? `process_message`? ????.

### 4.4 ?? ? ?? ??
- ???? ??? ??????? ?? ? `HAL_I2C_S_Reset`? ????(`app/hal_i2c_slave.c:211`).
- ?? ???? ????? ????? ??? ?? ??? ????(`app/hal_i2c_slave.c:187`, `app/hal_i2c_slave.c:259`).
- ????? ??? ??? ??? ???? ??? ??? ????(`src/hal_scheduler.c:39`, `src/hal_scheduler.c:93`).

## 5. SWE.3 - ????? ?? ?? ? ??

### 5.1 ?? ?? ??(?? ??)
| ?? | ?? | ?? | ?? | ?? |
|------|------|------|------|------|
| `HAL_I2C_S_Init` | ???? ???, ?? ?? ??, ???? ?? | ?? ?? ??? | ?? | `app/hal_i2c_slave.c:153` |
| `HAL_I2C_S_OnByteReceived` | ?? ???? ???? ???? ?? ??? ?? | ??? ??? | ?? | `app/hal_i2c_slave.c:179` |
| `HAL_I2C_S_Tick1ms` | ??? ? ????? ???? ??? ???? ?? | ? ?? | ?? | `app/hal_i2c_slave.c:245` |
| `HAL_SCHED_RunOnce` | ??? ?? ??? ??? ?? | ?? | ?? | `src/hal_scheduler.c:67` |
| `App_I2C_ErrorHandler` | HAL ??? ?? ?????? ? ?? | ?? ???? ??? | ?? | `src/app_main.c:47` |

### 5.2 ????
- `hal_i2c_context_t` (? ??, ?? ? ???, ?? ?? ??).
- `hal_sched_task_t` (?? ???, ????, ??).

### 5.3 ??? ??
- ???? ?: 1 ms (`HAL_SCHED_Init(UINT16_C(1000))`, `timer_isr.c`).
- ??? ?? ??? ??: 1 ms (`src/app_main.c:17`).
- ????? ??? ??: 10 ms (`src/app_main.c:18`).
- I2C ??? ????: 5 ms (`HAL_I2C_SLAVE_TIMEOUT_MS`).

### 5.4 ?? ?? ??
| ?? | ?? ?? | ?? ?? | ?? |
|------|-----------|-----------|------|
| ???? ?? ?? | `HAL_I2C_S_OnHardwareError` | ?? ??, ???? ?? | `app/hal_i2c_slave.c:211` |
| ?? ??? | `HAL_I2C_S_OnByteReceived`? ? ?? ?? | ?? ??, ???? ?? | `app/hal_i2c_slave.c:187` |
| ???? | `HAL_I2C_S_Tick1ms` | ?? ??, ???? ?? | `app/hal_i2c_slave.c:259` |
| ??? STOP | ?? ?? ?? ? `HAL_I2C_S_OnStopCondition` | ??? ?? ?? | `app/hal_i2c_slave.c:225` |

### 5.5 ?? ????
| ???? | ???? ?? | ?? ?? / ?? |
|-----------|---------------|-------------------|
| REQ-I2C-001 | ??? ???(HAL_I2C) | `app/hal_i2c_slave.c:155-206`, `src/app_main.c:27-38` |
| REQ-I2C-002 | ?? ?? ?? | `app/hal_i2c_slave.c:187-243`, `src/app_main.c:47-75` |
| REQ-I2C-003 | ???? ??? | `app/hal_i2c_slave.c:245-269` |
| REQ-I2C-004 | ??? ???? | `src/hal_scheduler.c:67-109`, `src/app_main.c:86-105` |
| REQ-I2C-005 | ?? ?? ????? | `include/hal_i2c_slave.h:39`, `app/hal_i2c_slave.c:119-146` |
| REQ-I2C-006 | HAL API ??? | `include/hal_i2c_slave.h:41-51`, `src/r_config_iica0_user.c` |

### 5.6 ?? ?? ????
- ?? ???? ???? I2C ???? ?? ???? ???????.
- ? ?? ??? ??? ?? ??? ????.
- ??? ?? ??? ???? ??? ????.
- ????? 0 ??? ? ??? ???? ??? ?? ??? ????.

## 6. ?? ??
- ??? MISRA C:2023 ??? ?? ???? ??? ?????? ????.
- ? ??? ????, ????, ?? ??? ? ??? ??? ASPICE SWE.1~SWE.3 ???? ????.
- ?? ASPICE ??? ???? ??, ??, ?? ?? ??? ???? ?? ? ?? ?? ???.

## 7. ?? ??
| ?? | ?? | ??? | ?? |
|-------|------|--------|------|
| 0.1 | 2025-09-28 | Codex Agent | ASPICE SWE ?? ?? ??. |

## 8. SWE.4 - ????? ?? ? ?? ?? ??
- **?? ??**: HAL, ????, ???? ?? ?? ? ??? ??? ????? ??? ????.
- **?? ??**: ?? ???? ??(`R_Config_IICA0_*`)? ?? HAL_I2C ??? ???? TM00 ISR? ?????? `HAL_SCHED_TickISR` ? `HAL_I2C_S_Tick1ms`? ????.
- **?? ??**:
  - HIL ?? ?????? ??? I2C ???? ???? ? ?? ? ?? ?? ??? ????.
  - ?? ??? ??, ?? START/STOP ???, ???? ?? ? ?? ??? ????.
  - ????? ??? ???? ???? ???? ????? ??? ??? ????.
- **??/?? ??**: ?? ???? REQ-I2C-001~REQ-I2C-006 ????? ?? ???? ??? ??? ??? ??.

## 9. SWE.5 - ????? ?? ?? ? ?? ????? ????

### 9.1 ?? ????? ??
| ?? | ?? | ?? | ?? | ?? ?? | ?? ?? | ?? |
|------|------|------|------|-----------|-----------|------|
| `HAL_I2C_S_Init(hal_i2c_error_callback_t error_cb)` | HAL | `error_cb`: ??? ?? ??? ??? | ?? | ???? ??? ??? ?? ??, ???? ??? | HAL ???? ??? ? ???? ??; ?? ?? ?? | ?? ?? ? ? ??? ??. |
| `HAL_I2C_S_Reset(void)` | HAL | ?? | ?? | I2C ???? ??? ?? | I2C ????? ?? ? ???, ?? ??? ??? | ?? ?? ? ??. |
| `HAL_I2C_S_PopMessage(hal_i2c_message_t *message)` | HAL | `message`: ?? ?? ?? ??? | `bool`: ??? ?? ?? | ? ??? ???? ??? ? ?? | ?? ? ?? ???? ???? head/tail? ?? | ??? ???? ???? ??? FALSE ??. |
| `HAL_I2C_S_OnStartCondition(uint8_t hw_status_flags)` | HAL (ISR) | ???? ?? ?? | ?? | I2C START ???? ??? | ? ??? ?? ??, ???? ??? ?? | ??? ?? ??? ??. |
| `HAL_I2C_S_OnByteReceived(uint8_t data)` | HAL (ISR) | ?? ??? | ?? | `receiving` ??? true | ??? ?? ?? ??? ?? | ??? ? ?? ?? ? ???? ??. |
| `HAL_I2C_S_OnStopCondition(uint8_t hw_status_flags)` | HAL (ISR) | ???? ?? ?? | ?? | ??? ?? ? | ??? ??? ???? ?? ?? | ?? ?? ??? ??? ?? ??. |
| `HAL_I2C_S_OnHardwareError(uint8_t hw_status_flags)` | HAL (ISR) | ?? ??? | ?? | ???? ?? ?? | ?? ?? ?? ? ???? ?? | ?? ????? ????. |
| `HAL_I2C_S_Tick1ms(void)` | HAL | ?? | ?? | 1 ms?? ?? | ???? ??? ??, ?? ? ???? ?? | ???? ? ??? ??. |
| `HAL_SCHED_Init(uint16_t tick_hz)` | ???? | ? ???(Hz) | ?? | ?? | ???? ???? ???, ?? ?? ?? | ??? ??? ?? `tick_hz` > 0 ??. |
| `HAL_SCHED_RegisterTasks(hal_sched_task_t *tasks, uint8_t task_count)` | ???? | ??? ?? ???, ??? ? | ?? | `tasks` ??? `task_count` ??? ??? | ?? ? ???? ???? ??? | ?/0 ?? ? ???? ???. |
| `HAL_SCHED_TickISR(void)` | ???? (ISR) | ?? | ?? | ??? ISR ??? | ??? ? ?? | ??? ??? ??? ??. |
| `HAL_SCHED_RunOnce(void)` | ???? | ?? | ?? | ???? ??? | ??? ???? ???? ?? | ???? ?? ???? ???. |
| `App_I2C_ErrorHandler(const hal_i2c_error_context_t *context)` | ?????? | ?? ???? ??? | ?? | HAL ?? ??? ??? | ?? ??, ?? ? ?? ?? ?? | MISRA? ?? ? ????? ??. |
| `process_message(const hal_i2c_message_t *message)` | ?????? | ??? ??? | ?? | ???? ????? ?? | ?????? ?? ??? ?? | ????? ?? ?? ??. |
| `TM00_ISR(void)` | ISR | ?? | ?? | ??? ???? ?? ?? | ???? ?? HAL ???? ?? | ?? ??? ?? pragma ??. |
| `R_Config_IICA0_*Callback(...)` | ISR ?? | ?????? ??? ??/??? | ?? | ????? ??? ????? ??? | ???? HAL? ?? | `src/r_config_iica0_user.c`?? ??. |

### 9.2 ?? ??? ?? ?????
- **??? ????**: ????? TC ID? ????(?: TC-I2C-001? START/???/STOP ???? ???? `HAL_I2C_S_PopMessage`? ??? REQ-I2C-001? ??).
- **????? ???**: ? ???, 0? ???, ??? ???? ??? ??? ?? ?? ???? ????.
- **??? ??**: ??? ??? ??? `HAL_I2C_S_Tick1ms` ???? ???? ?? ?? ??? ????? ????.
- **?? ??**: ? ???? ?? ???? ?? `App_I2C_ErrorHandler`? ??? ??? ???? ?? ??? ????? ????.

### 9.3 ?? ???
- ? ?? ??? ??? ??? TC ??.
- ? ????? ?? ?? ??? ?? ??? ??? ?? ??.
- SWE.4/SWE.5 ???? ????? ????? ??? ?? ??? ??? ??.
